# Query Internal Data Sources{#queryInternalDataSources}


```{r spatialAnalysis setup, include=FALSE}
```

Accessing internal DEQ data sources has been a longtime goal of many R programmers. Connecting a local R instance to raw data allows for increased automation and reduces redundant data copies on local drives. However, querying data directly from internal resources into one's local environment is a privilege and requires a number of R skills and approval from OIS. 

Database operations rely on the SQL language. Users must first familiarize themselves with the basics of database operations with SQL. The [DataCamp Introduction to SQL course](https://www.datacamp.com/courses/introduction-to-sql){target="_blank"} is a good starting point. Additionally, the [DataCarpentry SQL databases and R](https://datacarpentry.org/R-ecology-lesson/05-r-and-databases.html){target="_blank"} course provides is a good practice before seeking a direct, read-only connection to ODS (the SQLServer back end of CEDS).

After you have **demonstrated proficiency** manipulating smaller, local data sources in R, you may submit a [Special Network Access Form](https://deqnet.deq.virginia.gov/programs/admin/ois/forms/documents/Special_Network_Access_Request_Form.pdf){target="_blank"} to OIS seeking access to ODS data view using your Microsoft credentials. After OIS approval, you may access ODS from R following the connection instructions in the [Connect to ODS](#connectToODS) module. 

Alternatively, data "pinned" on the R server are available to all staff (on the internal network or VPN) without OIS authorization. Many pre-analyzed data sources are available to be pulled into your local R environment to assist with projects. See the [Connecting to R Connect (for Pinned Data)](#connectToConnectPins) module for more information on connecting your local environment to the R server to query these internal data resources. 

## Connecting to R Connect (for Pinned Data){#connectToConnectPins}

**Section Contact: Emma Jones (emma.jones@deq.virginia.gov)**

```{r child = 'subchapters/connectToConnectPins.Rmd'}
```

## Connect to ODS{#connectToODS}

**Section Contact: Emma Jones (emma.jones@deq.virginia.gov)**

```{r child = 'subchapters/connectToODS.Rmd'}
```


## Querying Data from ODS{#queryDataFromODS}

**Section Contact: Emma Jones (emma.jones@deq.virginia.gov)**

```{r child = 'subchapters/queryDataFromODS.Rmd'}
```


## Common WQM queries{#commonWQMqueries}

**Section Contact: Emma Jones (emma.jones@deq.virginia.gov)**

```{r child = 'subchapters/commonWQMqueries.Rmd'}
```

## Common Benthic queries{#commonBenthicqueries}

Coming Soon!

## Common Fish queries

**Section Contact: Emma Jones (emma.jones@deq.virginia.gov)**

DEQ's fish data do not live in CEDS at present. the BRRO water monitoring team makes this data available via the [Fish EDAS](https://rconnect.deq.virginia.gov/FishEDAS/) shiny app on the R Connect server, which is great for quick queries, visualizing data, or answering basic questions. When you need to dig in deeper to the data, you need access to the raw data. The only way to access raw fish data are by contacting the BRRO monitoring team (jason.hill@deq.virginia.gov, royce.steiner@deq.virginia.gov, & adam.walker@deq.virginia.gov) to acquire the Access database or by pulling the pinned versions of this data hosted on the R connect server. 


### Use Case: Automating a Fish Word Bank Query

```{r child = 'subchapters/FishWordBank.Rmd'}
```


## Common WQA queries{#commonWQAqueries}

Coming Soon!

## Common TMDL queries{#commonTMDLqueries}

Coming Soon!

## Test Your Knowledge: Data Science Learning Activity

**Section Contact: Joe Famularo (joe.famularo@deq.virginia.gov)**

Often the best way to learn a coding language or database environment (or both!) is to just dig in and try to answer some questions. It can be difficult at first to create new questions to ask of a dataset if you are unfamiliar with what common questions might need to be asked. The R Team has pulled together some questions to challenge your data science problem solving abilities and allow you to explore multiple data resources using your R environment. 

In order to complete some of these activities, you will need access to ODS and pinned data on the R server. Please see these articles prior to attempting the following exercises:

* [Connecting to R Connect (for Pinned Data)](#connectToConnectPins)
* [Connect to ODS](#connectToODS)

One method to solve each activity is provided in the [key](#data-science-activity-key). There can often be multiple ways to solve a problem, so don't be discouraged if your method does not follow the key methodology. Use the key as a learning tool to familiarize yourself with efficient problem solving skills.  

### Data Science Activity

```{r child = 'subchapters/DEQ_Data_Science_Primer.Rmd'}
```

### Data Science Activity Key

```{r child = 'subchapters/DEQ_Data_Science_Primer_Key.Rmd'}
```

