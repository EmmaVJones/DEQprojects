<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.6 Common Fish queries | DEQ R Methods Encyclopedia</title>
  <meta name="description" content="Simple reprex of common tasks DEQ staff encounter and how to complete them with R." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2.6 Common Fish queries | DEQ R Methods Encyclopedia" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Simple reprex of common tasks DEQ staff encounter and how to complete them with R." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.6 Common Fish queries | DEQ R Methods Encyclopedia" />
  
  <meta name="twitter:description" content="Simple reprex of common tasks DEQ staff encounter and how to complete them with R." />
  

<meta name="author" content="DEQ R Development Team" />


<meta name="date" content="2023-09-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="commonBenthicqueries.html"/>
<link rel="next" href="commonWQAqueries.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.49.4/plotly-latest.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.13/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="assets/book.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DEQ R Methods Encyclopedia</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Background</a>
<ul>
<li class="chapter" data-level="1.1" data-path="whyR.html"><a href="whyR.html"><i class="fa fa-check"></i><b>1.1</b> Why R?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="whyR.html"><a href="whyR.html#accessible-open-source-software"><i class="fa fa-check"></i><b>1.1.1</b> Accessible, Open Source Software</a></li>
<li class="chapter" data-level="1.1.2" data-path="whyR.html"><a href="whyR.html#automation-and-reproducibility"><i class="fa fa-check"></i><b>1.1.2</b> Automation and Reproducibility</a></li>
<li class="chapter" data-level="1.1.3" data-path="whyR.html"><a href="whyR.html#r-products"><i class="fa fa-check"></i><b>1.1.3</b> R Products</a></li>
<li class="chapter" data-level="1.1.4" data-path="whyR.html"><a href="whyR.html#summary"><i class="fa fa-check"></i><b>1.1.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="gettingStartedWithR.html"><a href="gettingStartedWithR.html"><i class="fa fa-check"></i><b>1.2</b> Getting Started With R</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="gettingStartedWithR.html"><a href="gettingStartedWithR.html#downloading-r-and-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> Downloading R and RStudio</a></li>
<li class="chapter" data-level="1.2.2" data-path="gettingStartedWithR.html"><a href="gettingStartedWithR.html#configuring-rstudio"><i class="fa fa-check"></i><b>1.2.2</b> Configuring RStudio</a></li>
<li class="chapter" data-level="1.2.3" data-path="gettingStartedWithR.html"><a href="gettingStartedWithR.html#downloading-packages"><i class="fa fa-check"></i><b>1.2.3</b> Downloading Packages</a></li>
<li class="chapter" data-level="1.2.4" data-path="gettingStartedWithR.html"><a href="gettingStartedWithR.html#how-to-learn-or-continue-learning-r"><i class="fa fa-check"></i><b>1.2.4</b> How to Learn (or Continue Learning) R?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="wantToContribute.html"><a href="wantToContribute.html"><i class="fa fa-check"></i><b>1.3</b> Want to Contribute?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="queryInternalDataSources.html"><a href="queryInternalDataSources.html"><i class="fa fa-check"></i><b>2</b> Query Internal Data Sources</a>
<ul>
<li class="chapter" data-level="2.1" data-path="connectToConnectPins.html"><a href="connectToConnectPins.html"><i class="fa fa-check"></i><b>2.1</b> Connecting to R Connect (for Pinned Data)</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="connectToConnectPins.html"><a href="connectToConnectPins.html#api-keys"><i class="fa fa-check"></i><b>2.1.1</b> API Keys</a></li>
<li class="chapter" data-level="2.1.2" data-path="connectToConnectPins.html"><a href="connectToConnectPins.html#connect-to-the-r-server"><i class="fa fa-check"></i><b>2.1.2</b> Connect to the R server</a></li>
<li class="chapter" data-level="2.1.3" data-path="connectToConnectPins.html"><a href="connectToConnectPins.html#browse-available-pins"><i class="fa fa-check"></i><b>2.1.3</b> Browse Available Pins</a></li>
<li class="chapter" data-level="2.1.4" data-path="connectToConnectPins.html"><a href="connectToConnectPins.html#access-a-pin"><i class="fa fa-check"></i><b>2.1.4</b> Access a Pin</a></li>
<li class="chapter" data-level="2.1.5" data-path="connectToConnectPins.html"><a href="connectToConnectPins.html#query-some-of-a-pin"><i class="fa fa-check"></i><b>2.1.5</b> Query (some of) a Pin</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="connectToODS.html"><a href="connectToODS.html"><i class="fa fa-check"></i><b>2.2</b> Connect to ODS</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="connectToODS.html"><a href="connectToODS.html#credentials-local-vs-remote"><i class="fa fa-check"></i><b>2.2.1</b> Credentials (Local vs Remote)</a></li>
<li class="chapter" data-level="2.2.2" data-path="connectToODS.html"><a href="connectToODS.html#required-packages"><i class="fa fa-check"></i><b>2.2.2</b> Required Packages</a></li>
<li class="chapter" data-level="2.2.3" data-path="connectToODS.html"><a href="connectToODS.html#dbi-method-for-ods-connection"><i class="fa fa-check"></i><b>2.2.3</b> DBI Method for ODS Connection</a></li>
<li class="chapter" data-level="2.2.4" data-path="connectToODS.html"><a href="connectToODS.html#pool-method-for-ods-connection"><i class="fa fa-check"></i><b>2.2.4</b> Pool Method for ODS Connection</a></li>
<li class="chapter" data-level="2.2.5" data-path="connectToODS.html"><a href="connectToODS.html#pool-method-query-data"><i class="fa fa-check"></i><b>2.2.5</b> Pool Method: Query Data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="queryDataFromODS.html"><a href="queryDataFromODS.html"><i class="fa fa-check"></i><b>2.3</b> Querying Data from ODS</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="queryDataFromODS.html"><a href="queryDataFromODS.html#connecting-and-disconnecting-from-a-database"><i class="fa fa-check"></i><b>2.3.1</b> Connecting and Disconnecting from a Database</a></li>
<li class="chapter" data-level="2.3.2" data-path="queryDataFromODS.html"><a href="queryDataFromODS.html#data-schema"><i class="fa fa-check"></i><b>2.3.2</b> Data Schema</a></li>
<li class="chapter" data-level="2.3.3" data-path="queryDataFromODS.html"><a href="queryDataFromODS.html#data-views-interaction"><i class="fa fa-check"></i><b>2.3.3</b> Data Views Interaction</a></li>
<li class="chapter" data-level="2.3.4" data-path="queryDataFromODS.html"><a href="queryDataFromODS.html#data-update-frequency"><i class="fa fa-check"></i><b>2.3.4</b> Data Update Frequency</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="commonWQMqueries.html"><a href="commonWQMqueries.html"><i class="fa fa-check"></i><b>2.4</b> Common WQM queries</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="commonWQMqueries.html"><a href="commonWQMqueries.html#connect-to-internal-data-resources"><i class="fa fa-check"></i><b>2.4.1</b> Connect to Internal Data Resources</a></li>
<li class="chapter" data-level="2.4.2" data-path="commonWQMqueries.html"><a href="commonWQMqueries.html#query-all-water-monitoring-data-from-a-provided-watershed"><i class="fa fa-check"></i><b>2.4.2</b> Query All Water Monitoring Data from a Provided Watershed</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="commonBenthicqueries.html"><a href="commonBenthicqueries.html"><i class="fa fa-check"></i><b>2.5</b> Common Benthic queries</a></li>
<li class="chapter" data-level="2.6" data-path="common-fish-queries.html"><a href="common-fish-queries.html"><i class="fa fa-check"></i><b>2.6</b> Common Fish queries</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="common-fish-queries.html"><a href="common-fish-queries.html#use-case-automating-a-fish-word-bank-query"><i class="fa fa-check"></i><b>2.6.1</b> Use Case: Automating a Fish Word Bank Query</a></li>
<li class="chapter" data-level="2.6.2" data-path="common-fish-queries.html"><a href="common-fish-queries.html#background-1"><i class="fa fa-check"></i><b>2.6.2</b> Background</a></li>
<li class="chapter" data-level="2.6.3" data-path="common-fish-queries.html"><a href="common-fish-queries.html#workflow"><i class="fa fa-check"></i><b>2.6.3</b> Workflow</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="commonWQAqueries.html"><a href="commonWQAqueries.html"><i class="fa fa-check"></i><b>2.7</b> Common WQA queries</a></li>
<li class="chapter" data-level="2.8" data-path="commonTMDLqueries.html"><a href="commonTMDLqueries.html"><i class="fa fa-check"></i><b>2.8</b> Common TMDL queries</a></li>
<li class="chapter" data-level="2.9" data-path="test-your-knowledge-data-science-learning-activity.html"><a href="test-your-knowledge-data-science-learning-activity.html"><i class="fa fa-check"></i><b>2.9</b> Test Your Knowledge: Data Science Learning Activity</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="test-your-knowledge-data-science-learning-activity.html"><a href="test-your-knowledge-data-science-learning-activity.html#data-science-activity"><i class="fa fa-check"></i><b>2.9.1</b> Data Science Activity</a></li>
<li class="chapter" data-level="2.9.2" data-path="test-your-knowledge-data-science-learning-activity.html"><a href="test-your-knowledge-data-science-learning-activity.html#data-science-activity-key"><i class="fa fa-check"></i><b>2.9.2</b> Data Science Activity Key</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="spatialAnalysis.html"><a href="spatialAnalysis.html"><i class="fa fa-check"></i><b>3</b> Spatial Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="spatialDataFromTabularData.html"><a href="spatialDataFromTabularData.html"><i class="fa fa-check"></i><b>3.1</b> Spatial Data from Tabular Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="spatialDataFromTabularData.html"><a href="spatialDataFromTabularData.html#removing-spatial-information"><i class="fa fa-check"></i><b>3.1.1</b> Removing Spatial Information</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="consumingGISRESTservices.html"><a href="consumingGISRESTservices.html"><i class="fa fa-check"></i><b>3.2</b> Consuming GIS REST Services in R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="consumingGISRESTservices.html"><a href="consumingGISRESTservices.html#gis-rest-service-data"><i class="fa fa-check"></i><b>3.2.1</b> GIS Rest Service Data</a></li>
<li class="chapter" data-level="3.2.2" data-path="consumingGISRESTservices.html"><a href="consumingGISRESTservices.html#primary-deq-rest-endpoints"><i class="fa fa-check"></i><b>3.2.2</b> Primary DEQ REST Endpoints:</a></li>
<li class="chapter" data-level="3.2.3" data-path="consumingGISRESTservices.html"><a href="consumingGISRESTservices.html#how-do-you-know-what-fieldscriteria-to-query-on"><i class="fa fa-check"></i><b>3.2.3</b> How do you know what fields/criteria to query on?</a></li>
<li class="chapter" data-level="3.2.4" data-path="consumingGISRESTservices.html"><a href="consumingGISRESTservices.html#okaylets-build-a-simple-query-and-see-it-in-r"><i class="fa fa-check"></i><b>3.2.4</b> Okay…let’s build a simple query and see it in R…</a></li>
<li class="chapter" data-level="3.2.5" data-path="consumingGISRESTservices.html"><a href="consumingGISRESTservices.html#querying-multiple-records"><i class="fa fa-check"></i><b>3.2.5</b> Querying multiple records:</a></li>
<li class="chapter" data-level="3.2.6" data-path="consumingGISRESTservices.html"><a href="consumingGISRESTservices.html#this-works-on-lines-and-polygons-as-well"><i class="fa fa-check"></i><b>3.2.6</b> This works on lines and polygons as well!:</a></li>
<li class="chapter" data-level="3.2.7" data-path="consumingGISRESTservices.html"><a href="consumingGISRESTservices.html#building-more-advanced-queries"><i class="fa fa-check"></i><b>3.2.7</b> Building more advanced queries</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="spatialOperationsGISRESTservices.html"><a href="spatialOperationsGISRESTservices.html"><i class="fa fa-check"></i><b>3.3</b> Spatial Operations on GIS REST Services in R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="spatialOperationsGISRESTservices.html"><a href="spatialOperationsGISRESTservices.html#gis-rest-service-data-1"><i class="fa fa-check"></i><b>3.3.1</b> GIS Rest Service Data</a></li>
<li class="chapter" data-level="3.3.2" data-path="spatialOperationsGISRESTservices.html"><a href="spatialOperationsGISRESTservices.html#level-up-your-querying-game"><i class="fa fa-check"></i><b>3.3.2</b> Level Up Your Querying Game</a></li>
<li class="chapter" data-level="3.3.3" data-path="spatialOperationsGISRESTservices.html"><a href="spatialOperationsGISRESTservices.html#set-up-your-environment"><i class="fa fa-check"></i><b>3.3.3</b> Set Up Your Environment</a></li>
<li class="chapter" data-level="3.3.4" data-path="spatialOperationsGISRESTservices.html"><a href="spatialOperationsGISRESTservices.html#query-one-layer"><i class="fa fa-check"></i><b>3.3.4</b> Query One Layer</a></li>
<li class="chapter" data-level="3.3.5" data-path="spatialOperationsGISRESTservices.html"><a href="spatialOperationsGISRESTservices.html#query-layer-two-based-on-information-from-layer-one"><i class="fa fa-check"></i><b>3.3.5</b> Query Layer Two Based On Information From Layer One</a></li>
<li class="chapter" data-level="3.3.6" data-path="spatialOperationsGISRESTservices.html"><a href="spatialOperationsGISRESTservices.html#spatially-intersect-layers"><i class="fa fa-check"></i><b>3.3.6</b> Spatially Intersect Layers</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="usingSpatialDatasets.html"><a href="usingSpatialDatasets.html"><i class="fa fa-check"></i><b>3.4</b> Using Spatial Datasets</a></li>
<li class="chapter" data-level="3.5" data-path="interactiveMapping.html"><a href="interactiveMapping.html"><i class="fa fa-check"></i><b>3.5</b> Interactive Mapping</a></li>
<li class="chapter" data-level="3.6" data-path="watershed-delineation.html"><a href="watershed-delineation.html"><i class="fa fa-check"></i><b>3.6</b> Watershed Delineation</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="watershed-delineation.html"><a href="watershed-delineation.html#single-station-delineation"><i class="fa fa-check"></i><b>3.6.1</b> Single Station Delineation</a></li>
<li class="chapter" data-level="3.6.2" data-path="watershed-delineation.html"><a href="watershed-delineation.html#multiple-station-delineation"><i class="fa fa-check"></i><b>3.6.2</b> Multiple Station Delineation</a></li>
<li class="chapter" data-level="3.6.3" data-path="watershed-delineation.html"><a href="watershed-delineation.html#qa"><i class="fa fa-check"></i><b>3.6.3</b> QA</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="landcover-analysis.html"><a href="landcover-analysis.html"><i class="fa fa-check"></i><b>3.7</b> Landcover analysis</a></li>
<li class="chapter" data-level="3.8" data-path="spatial-joins.html"><a href="spatial-joins.html"><i class="fa fa-check"></i><b>3.8</b> Spatial joins</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="spatial-joins.html"><a href="spatial-joins.html#case-study-water-permit-review"><i class="fa fa-check"></i><b>3.8.1</b> Case Study: Water Permit Review</a></li>
<li class="chapter" data-level="3.8.2" data-path="spatial-joins.html"><a href="spatial-joins.html#polygons-of-interest"><i class="fa fa-check"></i><b>3.8.2</b> Polygons of Interest</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="shinyAppHelp.html"><a href="shinyAppHelp.html"><i class="fa fa-check"></i><b>4</b> Shiny App Pro Tips</a>
<ul>
<li class="chapter" data-level="4.1" data-path="shiny-file-organization.html"><a href="shiny-file-organization.html"><i class="fa fa-check"></i><b>4.1</b> Shiny file organization</a></li>
<li class="chapter" data-level="4.2" data-path="shiny-tricks.html"><a href="shiny-tricks.html"><i class="fa fa-check"></i><b>4.2</b> Shiny Tricks</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="shiny-tricks.html"><a href="shiny-tricks.html#mandatory-shiny-inputs"><i class="fa fa-check"></i><b>4.2.1</b> Mandatory Shiny Inputs</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="markdown-and-user-friendly-output-files.html"><a href="markdown-and-user-friendly-output-files.html"><i class="fa fa-check"></i><b>4.3</b> Markdown and User-Friendly Output Files</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bestPractices.html"><a href="bestPractices.html"><i class="fa fa-check"></i><b>5</b> Best Practices</a>
<ul>
<li class="chapter" data-level="5.1" data-path="versionControl.html"><a href="versionControl.html"><i class="fa fa-check"></i><b>5.1</b> Version Control</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="versionControl.html"><a href="versionControl.html#what-is-version-control"><i class="fa fa-check"></i><b>5.1.1</b> What is Version Control?</a></li>
<li class="chapter" data-level="5.1.2" data-path="versionControl.html"><a href="versionControl.html#git-basics"><i class="fa fa-check"></i><b>5.1.2</b> Git Basics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="miscTips.html"><a href="miscTips.html"><i class="fa fa-check"></i><b>6</b> Miscellaeous Tips and Tricks</a>
<ul>
<li class="chapter" data-level="6.1" data-path="regular-expression-and-pattern-matching.html"><a href="regular-expression-and-pattern-matching.html"><i class="fa fa-check"></i><b>6.1</b> Regular expression and pattern matching</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="regular-expression-and-pattern-matching.html"><a href="regular-expression-and-pattern-matching.html#regexOverview"><i class="fa fa-check"></i><b>6.1.1</b> Example Data Overview</a></li>
<li class="chapter" data-level="6.1.2" data-path="regular-expression-and-pattern-matching.html"><a href="regular-expression-and-pattern-matching.html#regexInR"><i class="fa fa-check"></i><b>6.1.2</b> Common R Commands and How to Use Them</a></li>
<li class="chapter" data-level="6.1.3" data-path="regular-expression-and-pattern-matching.html"><a href="regular-expression-and-pattern-matching.html#regexBasics"><i class="fa fa-check"></i><b>6.1.3</b> Basic Regular Expressions</a></li>
<li class="chapter" data-level="6.1.4" data-path="regular-expression-and-pattern-matching.html"><a href="regular-expression-and-pattern-matching.html#regexCharacters"><i class="fa fa-check"></i><b>6.1.4</b> Character Classes</a></li>
<li class="chapter" data-level="6.1.5" data-path="regular-expression-and-pattern-matching.html"><a href="regular-expression-and-pattern-matching.html#regexQuantifiers"><i class="fa fa-check"></i><b>6.1.5</b> Quantifiers</a></li>
<li class="chapter" data-level="6.1.6" data-path="regular-expression-and-pattern-matching.html"><a href="regular-expression-and-pattern-matching.html#regexAnchors"><i class="fa fa-check"></i><b>6.1.6</b> Anchors</a></li>
<li class="chapter" data-level="6.1.7" data-path="regular-expression-and-pattern-matching.html"><a href="regular-expression-and-pattern-matching.html#regexExamples"><i class="fa fa-check"></i><b>6.1.7</b> Common or Useful Patterns</a></li>
<li class="chapter" data-level="6.1.8" data-path="regular-expression-and-pattern-matching.html"><a href="regular-expression-and-pattern-matching.html#regexResources"><i class="fa fa-check"></i><b>6.1.8</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="non-standard-evaluation.html"><a href="non-standard-evaluation.html"><i class="fa fa-check"></i><b>6.2</b> Non standard evaluation</a></li>
<li class="chapter" data-level="6.3" data-path="accessAPIfromR.html"><a href="accessAPIfromR.html"><i class="fa fa-check"></i><b>6.3</b> Accessing APIs from R</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="accessAPIfromR.html"><a href="accessAPIfromR.html#what-is-an-api"><i class="fa fa-check"></i><b>6.3.1</b> What is an API</a></li>
<li class="chapter" data-level="6.3.2" data-path="accessAPIfromR.html"><a href="accessAPIfromR.html#CMCuseCase"><i class="fa fa-check"></i><b>6.3.2</b> CMC API Use Case</a></li>
<li class="chapter" data-level="6.3.3" data-path="accessAPIfromR.html"><a href="accessAPIfromR.html#required-packages-1"><i class="fa fa-check"></i><b>6.3.3</b> Required Packages</a></li>
<li class="chapter" data-level="6.3.4" data-path="accessAPIfromR.html"><a href="accessAPIfromR.html#explore-the-endpoint-in-a-browser"><i class="fa fa-check"></i><b>6.3.4</b> Explore the endpoint in a browser</a></li>
<li class="chapter" data-level="6.3.5" data-path="accessAPIfromR.html"><a href="accessAPIfromR.html#query-api-with-r"><i class="fa fa-check"></i><b>6.3.5</b> Query API with R</a></li>
<li class="chapter" data-level="6.3.6" data-path="accessAPIfromR.html"><a href="accessAPIfromR.html#example-query-cmc-api-for-assessment-uses"><i class="fa fa-check"></i><b>6.3.6</b> Example: Query CMC API for Assessment Uses</a></li>
<li class="chapter" data-level="6.3.7" data-path="accessAPIfromR.html"><a href="accessAPIfromR.html#parting-challenge"><i class="fa fa-check"></i><b>6.3.7</b> Parting Challenge</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="scrapeDataFromFTP.html"><a href="scrapeDataFromFTP.html"><i class="fa fa-check"></i><b>6.4</b> Scrape Data from an FTP Site</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="scrapeDataFromFTP.html"><a href="scrapeDataFromFTP.html#what-is-an-ftp"><i class="fa fa-check"></i><b>6.4.1</b> What is an FTP?</a></li>
<li class="chapter" data-level="6.4.2" data-path="scrapeDataFromFTP.html"><a href="scrapeDataFromFTP.html#tiger-dataset-use-case"><i class="fa fa-check"></i><b>6.4.2</b> TIGER Dataset Use Case</a></li>
<li class="chapter" data-level="6.4.3" data-path="scrapeDataFromFTP.html"><a href="scrapeDataFromFTP.html#required-packages-2"><i class="fa fa-check"></i><b>6.4.3</b> Required Packages</a></li>
<li class="chapter" data-level="6.4.4" data-path="scrapeDataFromFTP.html"><a href="scrapeDataFromFTP.html#build-base-ftp-web-address-call"><i class="fa fa-check"></i><b>6.4.4</b> Build Base FTP Web Address Call</a></li>
<li class="chapter" data-level="6.4.5" data-path="scrapeDataFromFTP.html"><a href="scrapeDataFromFTP.html#custom-tigerroads-ftp-function"><i class="fa fa-check"></i><b>6.4.5</b> Custom TIGERroads FTP function</a></li>
<li class="chapter" data-level="6.4.6" data-path="scrapeDataFromFTP.html"><a href="scrapeDataFromFTP.html#parse-data-into-single-file"><i class="fa fa-check"></i><b>6.4.6</b> Parse Data into Single File</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DEQ R Methods Encyclopedia</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="common-fish-queries" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Common Fish queries</h2>
<p><strong>Section Contact: Emma Jones (<a href="mailto:emma.jones@deq.virginia.gov" class="email">emma.jones@deq.virginia.gov</a>)</strong></p>
<p>DEQ’s fish data do not live in CEDS at present. the BRRO water monitoring team makes this data available via the <a href="https://rconnect.deq.virginia.gov/FishEDAS/">Fish EDAS</a> shiny app on the R Connect server, which is great for quick queries, visualizing data, or answering basic questions. When you need to dig in deeper to the data, you need access to the raw data. The only way to access raw fish data are by contacting the BRRO monitoring team (<a href="mailto:jason.hill@deq.virginia.gov" class="email">jason.hill@deq.virginia.gov</a>, <a href="mailto:royce.steiner@deq.virginia.gov" class="email">royce.steiner@deq.virginia.gov</a>, &amp; <a href="mailto:adam.walker@deq.virginia.gov" class="email">adam.walker@deq.virginia.gov</a>) to acquire the Access database or by pulling the pinned versions of this data hosted on the R connect server.</p>
<div id="use-case-automating-a-fish-word-bank-query" class="section level3" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> Use Case: Automating a Fish Word Bank Query</h3>
</div>
<div id="background-1" class="section level3" number="2.6.2">
<h3><span class="header-section-number">2.6.2</span> Background</h3>
<p>The purpose of this script is to create a workflow that automates the querying of potential fish taxa lists for sites DEQ will sample in the future. A use case is demonstrated in the Freshwater ProbMon program. Each fall, biologists collect fish community data from randomly selected sites throughout Virginia in addition to other collocated biological (algae and benthic macroinvertebrate), chemical (field parameter and analyte), and habitat (relative bed stability and rapid biological protocols) data.</p>
<p>In order to provide the biological staff the best “word bank” of potential taxa at a given site, the <a href="https://rconnect.deq.virginia.gov/FishEDAS/">Fish EDAS</a> tool allows users to input a site or coordinates and retrieve all the fish taxa collected in the HUC 8 watershed containing the site/location. By having this “word bank” handy in the field, biologists can improve their field taxa identification, expediting the end of year fish voucher QA work and data entry.</p>
<p>While the shiny app version of this taxa word bank tool is handy for a few sites, it is not practical to use that user interface for many sites. This case study will demonstrate a workflow that uses the underlying methods and functions that make the Taxa Word Bank feature work in the shiny app, but it will operationalize it to run the analysis for every site that needs to be sampled in 2023. The end result of this analysis will output a workbook for all sites within each region with each site’s potential taxa list saved as a sheet in the workbook.</p>
</div>
<div id="workflow" class="section level3" number="2.6.3">
<h3><span class="header-section-number">2.6.3</span> Workflow</h3>
<p>One way to tackle this problem is to follow the workflow specified below. As with everything in programming languages, there are multiple potential avenues to get to the same result.</p>
<p>First, load some necessary packages.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="common-fish-queries.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb45-2"><a href="common-fish-queries.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pins)</span>
<span id="cb45-3"><a href="common-fish-queries.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(config)</span>
<span id="cb45-4"><a href="common-fish-queries.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb45-5"><a href="common-fish-queries.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code></pre></div>
<div id="identify-sites-that-need-taxa-lists" class="section level4" number="2.6.3.1">
<h4><span class="header-section-number">2.6.3.1</span> Identify Sites That Need Taxa Lists</h4>
<p>First we need a list of sites to operate on. We can use the <a href="https://covgov-my.sharepoint.com/:x:/g/personal/emma_jones_deq_virginia_gov/Ecc_cIUDRjdIkmo6w-Hv0GoBF5NCsts7_tAHkdhLP8nk6Q?e=qnPUdq">2023 “regional results” spreadsheet</a> published by the Freshwater ProbMon program to communicate which sites are in the Freshwater ProbMon sample draw for a given year. We need to use the information on the sheet called “Planning” as it contains all the sites that the biological teams will sample during the fall. To use this dataset, you can download a copy and source it locally, or you can “Copy to” your personal OneDrive and source the workbook like the example below. <em>Remember: your absolute file path will differ from the example provided!</em></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="common-fish-queries.html#cb46-1" aria-hidden="true" tabindex="-1"></a>regionalResults <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&#39;C:/Users/wmu43954/OneDrive - Commonwealth of Virginia/Freshwater ProbMon/2023/RegionalResults2023.xlsx&#39;</span>,</span>
<span id="cb46-2"><a href="common-fish-queries.html#cb46-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sheet =</span> <span class="st">&#39;Planning&#39;</span>)</span></code></pre></div>
<p>Let’s reduce the noise in this dataset and limit just to the information we will need. We will also convert this to a spatial object.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="common-fish-queries.html#cb47-1" aria-hidden="true" tabindex="-1"></a>regionalResults <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(regionalResults, Region, StationID, Latitude, Longitude) <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="common-fish-queries.html#cb47-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="st">&quot;Latitude&quot;</span>),  <span class="co"># make spatial layer using these columns</span></span>
<span id="cb47-3"><a href="common-fish-queries.html#cb47-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">remove =</span> F, <span class="co"># remove these lat/lon cols from df</span></span>
<span id="cb47-4"><a href="common-fish-queries.html#cb47-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">crs =</span> <span class="dv">4326</span>) <span class="co">#epsg wgs84 </span></span></code></pre></div>
</div>
<div id="bring-in-fish-data" class="section level4" number="2.6.3.2">
<h4><span class="header-section-number">2.6.3.2</span> Bring in Fish Data</h4>
<p>We can use pinned data on the R server to help answer these questions. We will need a HUC8 watershed layer and fish taxa occurrence by HUC8 to solve this problem. We will also need the full fish master taxa list and a dataset describing native/non native status to improve the output data utility.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="common-fish-queries.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># connect to the R server</span></span>
<span id="cb48-2"><a href="common-fish-queries.html#cb48-2" aria-hidden="true" tabindex="-1"></a>conn <span class="ot">&lt;-</span> config<span class="sc">::</span><span class="fu">get</span>(<span class="at">file =</span> <span class="st">&quot;C:/HardDriveBackup/R/configFile/config.yml&quot;</span>, <span class="co"># point this to your local config file</span></span>
<span id="cb48-3"><a href="common-fish-queries.html#cb48-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;connectionSettings&quot;</span>)</span>
<span id="cb48-4"><a href="common-fish-queries.html#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="common-fish-queries.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">board_register_rsconnect</span>(<span class="at">key =</span> conn<span class="sc">$</span>CONNECT_API_KEY,  </span>
<span id="cb48-6"><a href="common-fish-queries.html#cb48-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">server =</span> conn<span class="sc">$</span>CONNECT_SERVER)</span>
<span id="cb48-7"><a href="common-fish-queries.html#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="common-fish-queries.html#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="common-fish-queries.html#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co"># pull pins</span></span>
<span id="cb48-10"><a href="common-fish-queries.html#cb48-10" aria-hidden="true" tabindex="-1"></a>huc8 <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">pin_get</span>(<span class="st">&#39;ejones/huc8&#39;</span>, <span class="at">board =</span> <span class="st">&#39;rsconnect&#39;</span>)) <span class="co"># immediately convert this into a spatial object</span></span>
<span id="cb48-11"><a href="common-fish-queries.html#cb48-11" aria-hidden="true" tabindex="-1"></a>taxaByHUC8 <span class="ot">&lt;-</span> <span class="fu">pin_get</span>(<span class="st">&#39;ejones/fishTaxaByHUC8&#39;</span>, <span class="at">board =</span> <span class="st">&#39;rsconnect&#39;</span>)</span>
<span id="cb48-12"><a href="common-fish-queries.html#cb48-12" aria-hidden="true" tabindex="-1"></a>fishesMasterTaxa <span class="ot">&lt;-</span> <span class="fu">pin_get</span>(<span class="st">&quot;ejones/fishesMasterTaxa&quot;</span>, <span class="at">board =</span> <span class="st">&quot;rsconnect&quot;</span>)</span>
<span id="cb48-13"><a href="common-fish-queries.html#cb48-13" aria-hidden="true" tabindex="-1"></a>nativeStatus <span class="ot">&lt;-</span> <span class="fu">pin_get</span>(<span class="st">&quot;ejones/fishNativeStatusByHUC&quot;</span>, <span class="at">board =</span> <span class="st">&quot;rsconnect&quot;</span>)</span></code></pre></div>
</div>
<div id="geospatial-connections" class="section level4" number="2.6.3.3">
<h4><span class="header-section-number">2.6.3.3</span> Geospatial Connections</h4>
<p>Next, let’s link each site to the appropriate HUC8. We will do this using a spatial join and add a new field with this information.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="common-fish-queries.html#cb49-1" aria-hidden="true" tabindex="-1"></a>regionalResults <span class="ot">&lt;-</span>  <span class="fu">st_intersection</span>(regionalResults, huc8) </span></code></pre></div>
</div>
<div id="build-a-taxa-word-bank" class="section level4" number="2.6.3.4">
<h4><span class="header-section-number">2.6.3.4</span> Build a Taxa Word Bank</h4>
<p>Now we can use the station to HUC8 link and the <code>taxaByHUC8</code> dataset to isolate a potential taxa list for each site. The <code>taxaWordBankFunction()</code> is great to use if you just need an answer, but digging in to what custom functions do is helpful to improve your understanding of functional scripting for automation.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="common-fish-queries.html#cb50-1" aria-hidden="true" tabindex="-1"></a>taxaWordBankFunction <span class="ot">&lt;-</span> <span class="cf">function</span>( HUCSelected, taxaByHUC8, fishesMasterTaxa, nativeStatus){</span>
<span id="cb50-2"><a href="common-fish-queries.html#cb50-2" aria-hidden="true" tabindex="-1"></a>   taxaWordBank <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(taxaByHUC8, Taxa, <span class="sc">!!</span> HUCSelected)</span>
<span id="cb50-3"><a href="common-fish-queries.html#cb50-3" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb50-4"><a href="common-fish-queries.html#cb50-4" aria-hidden="true" tabindex="-1"></a>   taxaWordBank <span class="ot">&lt;-</span> taxaWordBank <span class="sc">%&gt;%</span> </span>
<span id="cb50-5"><a href="common-fish-queries.html#cb50-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-6"><a href="common-fish-queries.html#cb50-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">left_join</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(fishesMasterTaxa, FinalID, Family, Genus, Species), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;Taxa&#39;</span> <span class="ot">=</span> <span class="st">&#39;FinalID&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-7"><a href="common-fish-queries.html#cb50-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="at">joinColumn =</span> <span class="fu">paste</span>(Genus, Species)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-8"><a href="common-fish-queries.html#cb50-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">left_join</span>(nativeStatus <span class="sc">%&gt;%</span> </span>
<span id="cb50-9"><a href="common-fish-queries.html#cb50-9" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">mutate</span>(<span class="at">HUC8 =</span> <span class="fu">paste0</span>(<span class="dv">0</span>,HUC8)) <span class="sc">%&gt;%</span> <span class="co"># add back leading zero that excel drops</span></span>
<span id="cb50-10"><a href="common-fish-queries.html#cb50-10" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">filter</span>(HUC8 <span class="sc">%in%</span> <span class="sc">!!</span> HUCSelected) <span class="sc">%&gt;%</span> </span>
<span id="cb50-11"><a href="common-fish-queries.html#cb50-11" aria-hidden="true" tabindex="-1"></a>                 dplyr<span class="sc">::</span><span class="fu">select</span>(BINOMEN, <span class="st">`</span><span class="at">Native/Non Native Status</span><span class="st">`</span> <span class="ot">=</span> STATUS, <span class="st">`</span><span class="at">Native/Non Native Status Comments</span><span class="st">`</span> <span class="ot">=</span> COMMENTS), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;joinColumn&#39;</span> <span class="ot">=</span> <span class="st">&#39;BINOMEN&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-12"><a href="common-fish-queries.html#cb50-12" aria-hidden="true" tabindex="-1"></a>     dplyr<span class="sc">::</span><span class="fu">select</span>(Family, Genus, Species, <span class="st">`</span><span class="at">Common Name</span><span class="st">`</span> <span class="ot">=</span> Taxa, <span class="fu">everything</span>(), <span class="sc">-</span>joinColumn) <span class="sc">%&gt;%</span> </span>
<span id="cb50-13"><a href="common-fish-queries.html#cb50-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">arrange</span>(Family, Genus) <span class="sc">%&gt;%</span> </span>
<span id="cb50-14"><a href="common-fish-queries.html#cb50-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">contains</span>(HUCSelected)), <span class="fu">funs</span>(<span class="fu">as.numeric</span>(.)))</span>
<span id="cb50-15"><a href="common-fish-queries.html#cb50-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">names</span>(taxaWordBank)[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;n Collected in &#39;</span>, HUCSelected)</span>
<span id="cb50-16"><a href="common-fish-queries.html#cb50-16" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb50-17"><a href="common-fish-queries.html#cb50-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(taxaWordBank)</span>
<span id="cb50-18"><a href="common-fish-queries.html#cb50-18" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb50-19"><a href="common-fish-queries.html#cb50-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-20"><a href="common-fish-queries.html#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="co"># how to use function</span></span>
<span id="cb50-21"><a href="common-fish-queries.html#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="fu">taxaWordBankFunction</span>(<span class="st">&#39;03010201&#39;</span>, taxaByHUC8, fishesMasterTaxa, nativeStatus) <span class="sc">%&gt;%</span> <span class="fu">View</span>()</span></code></pre></div>
</div>
<div id="operationalize-the-taxa-word-bank" class="section level4" number="2.6.3.5">
<h4><span class="header-section-number">2.6.3.5</span> Operationalize the Taxa Word Bank</h4>
<p>The function above works well to pull taxa collection information and native/non native status by individual HUC8’s. However, we can’t throw our entire <code>regionalresults</code> object into the function and get the result we anticipate (try it just to verify this for yourself!). What we need to do next is pull together this information for each site and save it as a sheet in a workbook named by the site. Let’s build the workbook saving operation next and then throw it all together into a single workflow.</p>
<p><em>Pro Tip: identifying and breaking out each part of the problem you are trying to solve individually and then combining into a single solution is a great way to make larger problems more manageable when learning how to program workflows.</em></p>
</div>
<div id="write-many-sheets-to-a-single-workbook" class="section level4" number="2.6.3.6">
<h4><span class="header-section-number">2.6.3.6</span> Write many sheets to a single workbook</h4>
<p>We can use the openxlsx package to write multiple datasets to a single MS Excel workbook. First, let’s make two example datasets using the function above and test this works.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="common-fish-queries.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb51-2"><a href="common-fish-queries.html#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="common-fish-queries.html#cb51-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> regionalResults[<span class="dv">1</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="common-fish-queries.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(HUC8) <span class="sc">%&gt;%</span> <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb51-5"><a href="common-fish-queries.html#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">taxaWordBankFunction</span>(taxaByHUC8, fishesMasterTaxa, nativeStatus)</span>
<span id="cb51-6"><a href="common-fish-queries.html#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="common-fish-queries.html#cb51-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> regionalResults[<span class="dv">2</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb51-8"><a href="common-fish-queries.html#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(HUC8) <span class="sc">%&gt;%</span> <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb51-9"><a href="common-fish-queries.html#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">taxaWordBankFunction</span>(taxaByHUC8, fishesMasterTaxa, nativeStatus)</span>
<span id="cb51-10"><a href="common-fish-queries.html#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="common-fish-queries.html#cb51-11" aria-hidden="true" tabindex="-1"></a>list_of_datasets <span class="ot">&lt;-</span> <span class="fu">list</span>(x1, x2)</span>
<span id="cb51-12"><a href="common-fish-queries.html#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(list_of_datasets) <span class="ot">&lt;-</span> regionalResults<span class="sc">$</span>StationID[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb51-13"><a href="common-fish-queries.html#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(list_of_datasets, <span class="at">file =</span> <span class="st">&quot;testWorkbook.xlsx&quot;</span>)</span></code></pre></div>
<p>That did the trick!</p>
</div>
<div id="workflow-at-scale-with-loop" class="section level4" number="2.6.3.7">
<h4><span class="header-section-number">2.6.3.7</span> Workflow at scale with Loop</h4>
<p>Now let’s scale this to report on all the BRRO sites in the <code>regionalresults</code> object. By breaking our workflow into individual workbooks for each region, we can best meet the needs of our regional biologists. Each workbook will contain one spreadsheet per site.</p>
<p>There are two ways to solve this problem from here.</p>
<ol style="list-style-type: decimal">
<li>Use the purrr package for a more function and list-based solution</li>
<li>Shove what we have into a loop.</li>
</ol>
<p>For this example, we will stick with the loop method to keep the workflow at the lowest coding level possible to get the job done.</p>
</div>
<div id="an-aside-on-loops" class="section level4" number="2.6.3.8">
<h4><span class="header-section-number">2.6.3.8</span> An aside on loops</h4>
<p>Loops are great. Loops are slow. Loops are usually the first way people learn to make things happen in a programming language over a lot of stuff. As you are learning a language, you will need to know how to loop processes over multiple arguments, but as you develop as a programmer, you will need to learn how to optimize your code. Learning how to work with the purrr library is a better solution for computational effort and analysis time; however, it can take a higher programming baseline knowledge base to build these solutions. Read up on <a href="https://jennybc.github.io/purrr-tutorial/">purrr</a> to up your programming game. <a href="https://www.rebeccabarter.com/blog/2019-08-19_purrr">Here is another great resource</a>.</p>
</div>
<div id="save-one-region-to-a-workbook" class="section level4" number="2.6.3.9">
<h4><span class="header-section-number">2.6.3.9</span> Save One Region to a Workbook</h4>
<p>Isolating regions into individual workbooks makes the most sense for how the end user will interact with the data. Let’s start with BRRO and demonstrate the loop method to save one region’s worth of sites into a single workbook.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="common-fish-queries.html#cb52-1" aria-hidden="true" tabindex="-1"></a>BRROregionalResults <span class="ot">&lt;-</span> <span class="fu">filter</span>(regionalResults, Region <span class="sc">==</span> <span class="st">&#39;BRRO&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="common-fish-queries.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(StationID, <span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span> <span class="co"># make sure we don&#39;t have any duplicate sites, keep all other info about sites</span></span>
<span id="cb52-3"><a href="common-fish-queries.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HUC8 =</span> <span class="fu">as.character</span>(HUC8)) <span class="sc">%&gt;%</span> <span class="co"># change the HUC8 column from a factor to character so the taxaWordBankFunction() can accept the input</span></span>
<span id="cb52-4"><a href="common-fish-queries.html#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="co"># drop spatial component bc unneccessary from here out</span></span>
<span id="cb52-5"><a href="common-fish-queries.html#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="common-fish-queries.html#cb52-6" aria-hidden="true" tabindex="-1"></a>outputList <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb52-7"><a href="common-fish-queries.html#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="common-fish-queries.html#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(BRROregionalResults)){</span>
<span id="cb52-9"><a href="common-fish-queries.html#cb52-9" aria-hidden="true" tabindex="-1"></a>  outputList[[i]] <span class="ot">&lt;-</span> BRROregionalResults[i,] <span class="sc">%&gt;%</span></span>
<span id="cb52-10"><a href="common-fish-queries.html#cb52-10" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">pull</span>(HUC8) <span class="sc">%&gt;%</span> </span>
<span id="cb52-11"><a href="common-fish-queries.html#cb52-11" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">taxaWordBankFunction</span>(taxaByHUC8, fishesMasterTaxa, nativeStatus)</span>
<span id="cb52-12"><a href="common-fish-queries.html#cb52-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-13"><a href="common-fish-queries.html#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(outputList) <span class="ot">&lt;-</span> BRROregionalResults<span class="sc">$</span>StationID</span>
<span id="cb52-14"><a href="common-fish-queries.html#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(outputList, <span class="at">file =</span> <span class="st">&quot;BRRO_2023fishTaxaWordBank.xlsx&quot;</span>)</span></code></pre></div>
</div>
<div id="workflow-at-scale-with-purrrmap" class="section level4" number="2.6.3.10">
<h4><span class="header-section-number">2.6.3.10</span> Workflow at scale with purrr::map</h4>
<p>Once you understand the loop example, test yourself by using a purrr::map solution instead. You will learn two ways of using map here. Solution 1 outputs a list just like the loop example that can easily work with the write.xlsx function. Solution 2 introduces listcolumns inside tibbles. This is a more practical use, though it does not accomplish the quick utility with write.xlsx; however, this solution is worth mentioning because of the “sticky” nature of listcolumns and how one can iterate over tibbles with embedded listcolumns to expose the superpowers of tibbles.</p>
</div>
<div id="solution-1-list-output" class="section level4" number="2.6.3.11">
<h4><span class="header-section-number">2.6.3.11</span> Solution 1: list output</h4>
<p>This solution creates a list object by iterating over the BRROregionalResults$HUC8 field in the taxaWordBankFunction() function. See how .x and .f are defined in the simple map() call. We rename the tibbles inside the list the same way as above. Note how pluck() or baseR brackets can reveal the contents of the list object. Using View() on the list object shows you all the contents and allows you to explore more details about each item using the GUI viewer buttons on the right of each element.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="common-fish-queries.html#cb53-1" aria-hidden="true" tabindex="-1"></a>purrrSolution1 <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="at">.x =</span> BRROregionalResults<span class="sc">$</span>HUC8,</span>
<span id="cb53-2"><a href="common-fish-queries.html#cb53-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.f =</span> <span class="sc">~</span>{<span class="fu">taxaWordBankFunction</span>(.x, taxaByHUC8, fishesMasterTaxa, nativeStatus )})</span>
<span id="cb53-3"><a href="common-fish-queries.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(purrrSolution1) <span class="ot">&lt;-</span> BRROregionalResults<span class="sc">$</span>StationID</span>
<span id="cb53-4"><a href="common-fish-queries.html#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="common-fish-queries.html#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># how to preview one tibble inside the list object</span></span>
<span id="cb53-6"><a href="common-fish-queries.html#cb53-6" aria-hidden="true" tabindex="-1"></a>purrrSolution1 <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="dv">20</span>) </span>
<span id="cb53-7"><a href="common-fish-queries.html#cb53-7" aria-hidden="true" tabindex="-1"></a>purrrSolution1[[<span class="dv">20</span>]]</span>
<span id="cb53-8"><a href="common-fish-queries.html#cb53-8" aria-hidden="true" tabindex="-1"></a>purrrSolution1 <span class="sc">%&gt;%</span> <span class="fu">View</span>()</span>
<span id="cb53-9"><a href="common-fish-queries.html#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="common-fish-queries.html#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(purrrSolution1, <span class="at">file =</span> <span class="st">&quot;BRRO_2023fishTaxaWordBank2.xlsx&quot;</span>)</span></code></pre></div>
</div>
<div id="solution-2-listcolumns" class="section level4" number="2.6.3.12">
<h4><span class="header-section-number">2.6.3.12</span> Solution 2: listcolumns</h4>
<p>Solution 2 leverages listcolumns, potentially the most powerful element of tibbles. As stated above, the results of this solution do not easily work with write.xlsx(), but that is fine because this solution creates a more flexible output for further analyses. By embedding the results of taxaWordBankFunction() inside a listcolumn in the tibble that contains additional metadata about the analysis, we can use better data management practices should we require this result to carry into future iterative steps. See below how to extract information using tidy or base R commands from the <code>purrrSolution2</code> object.</p>
<p><em>Note: We had to change the function slightly to only accept one argument for this use case. That is okay because the additional arguments were input datasets that really shouldn’t change (for this workflow). Best practices would specify that users name all inputs to a function. Be aware of best practices, and then make a solution that you need to work, documenting the weaknesses where applicable.</em></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="common-fish-queries.html#cb54-1" aria-hidden="true" tabindex="-1"></a>taxaWordBankFunction2 <span class="ot">&lt;-</span> <span class="cf">function</span>( HUCSelected){</span>
<span id="cb54-2"><a href="common-fish-queries.html#cb54-2" aria-hidden="true" tabindex="-1"></a>   taxaWordBank <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(taxaByHUC8, Taxa, <span class="sc">!!</span> HUCSelected)</span>
<span id="cb54-3"><a href="common-fish-queries.html#cb54-3" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb54-4"><a href="common-fish-queries.html#cb54-4" aria-hidden="true" tabindex="-1"></a>   taxaWordBank <span class="ot">&lt;-</span> taxaWordBank <span class="sc">%&gt;%</span> </span>
<span id="cb54-5"><a href="common-fish-queries.html#cb54-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-6"><a href="common-fish-queries.html#cb54-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">left_join</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(fishesMasterTaxa, FinalID, Family, Genus, Species), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;Taxa&#39;</span> <span class="ot">=</span> <span class="st">&#39;FinalID&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-7"><a href="common-fish-queries.html#cb54-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="at">joinColumn =</span> <span class="fu">paste</span>(Genus, Species)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-8"><a href="common-fish-queries.html#cb54-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">left_join</span>(nativeStatus <span class="sc">%&gt;%</span> </span>
<span id="cb54-9"><a href="common-fish-queries.html#cb54-9" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">mutate</span>(<span class="at">HUC8 =</span> <span class="fu">paste0</span>(<span class="dv">0</span>,HUC8)) <span class="sc">%&gt;%</span> <span class="co"># add back leading zero that excel drops</span></span>
<span id="cb54-10"><a href="common-fish-queries.html#cb54-10" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">filter</span>(HUC8 <span class="sc">%in%</span> <span class="sc">!!</span> HUCSelected) <span class="sc">%&gt;%</span> </span>
<span id="cb54-11"><a href="common-fish-queries.html#cb54-11" aria-hidden="true" tabindex="-1"></a>                 dplyr<span class="sc">::</span><span class="fu">select</span>(BINOMEN, <span class="st">`</span><span class="at">Native/Non Native Status</span><span class="st">`</span> <span class="ot">=</span> STATUS, <span class="st">`</span><span class="at">Native/Non Native Status Comments</span><span class="st">`</span> <span class="ot">=</span> COMMENTS), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;joinColumn&#39;</span> <span class="ot">=</span> <span class="st">&#39;BINOMEN&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-12"><a href="common-fish-queries.html#cb54-12" aria-hidden="true" tabindex="-1"></a>     dplyr<span class="sc">::</span><span class="fu">select</span>(Family, Genus, Species, <span class="st">`</span><span class="at">Common Name</span><span class="st">`</span> <span class="ot">=</span> Taxa, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb54-13"><a href="common-fish-queries.html#cb54-13" aria-hidden="true" tabindex="-1"></a>     <span class="fu">arrange</span>(Family, Genus) <span class="sc">%&gt;%</span> </span>
<span id="cb54-14"><a href="common-fish-queries.html#cb54-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">contains</span>(HUCSelected)), <span class="fu">funs</span>(<span class="fu">as.numeric</span>(.)))</span>
<span id="cb54-15"><a href="common-fish-queries.html#cb54-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">names</span>(taxaWordBank)[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;n Collected in &#39;</span>, HUCSelected)</span>
<span id="cb54-16"><a href="common-fish-queries.html#cb54-16" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb54-17"><a href="common-fish-queries.html#cb54-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(taxaWordBank)</span>
<span id="cb54-18"><a href="common-fish-queries.html#cb54-18" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb54-19"><a href="common-fish-queries.html#cb54-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-20"><a href="common-fish-queries.html#cb54-20" aria-hidden="true" tabindex="-1"></a>purrrSolution2 <span class="ot">&lt;-</span> BRROregionalResults <span class="sc">%&gt;%</span> </span>
<span id="cb54-21"><a href="common-fish-queries.html#cb54-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">resultsAsListColumn =</span> <span class="fu">map</span>(HUC8, taxaWordBankFunction2)) </span>
<span id="cb54-22"><a href="common-fish-queries.html#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="common-fish-queries.html#cb54-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-24"><a href="common-fish-queries.html#cb54-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at contents</span></span>
<span id="cb54-25"><a href="common-fish-queries.html#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(purrrSolution2)</span>
<span id="cb54-26"><a href="common-fish-queries.html#cb54-26" aria-hidden="true" tabindex="-1"></a>purrrSolution2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(StationID <span class="sc">==</span> <span class="st">&#39;4AGSE015.67&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(resultsAsListColumn)</span>
<span id="cb54-27"><a href="common-fish-queries.html#cb54-27" aria-hidden="true" tabindex="-1"></a>purrrSolution2[<span class="dv">3</span>,]<span class="sc">$</span>resultsAsListColumn</span></code></pre></div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="commonBenthicqueries.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="commonWQAqueries.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": null
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
